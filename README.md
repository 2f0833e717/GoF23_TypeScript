# GoF23 Design Patterns in TypeScript

このプロジェクトは、Gang of Four（GoF）で定義された23のデザインパターンをTypeScriptで実装したものです。

## プロジェクト構造

```
Gof23_TypeScript/
├── src/
│   ├── creational/    # 生成パターン
│   │   ├── singleton/     # シングルトンパターン（実装済み）
│   │   ├── factory-method/# ファクトリーメソッドパターン（実装済み）
│   │   ├── abstract-factory/# 抽象ファクトリーパターン（実装済み）
│   │   ├── builder/       # ビルダーパターン（実装済み）
│   │   └── prototype/     # プロトタイプパターン（実装済み）
│   ├── structural/    # 構造パターン（実装済み）
│   ├── behavioral/    # 振る舞いパターン（実装済み）
│   └── common/        # 共通ユーティリティ
├── tests/            # テストコード
├── docs/             # ドキュメント
└── examples/         # 使用例
```

## 必要要件

- Node.js 18.0以上
- TypeScript 5.0以上

## セットアップ

1. リポジトリのクローン:
```bash
git clone [repository-url]
cd Gof23_TypeScript
```

2. 依存関係のインストール:
```bash
npm install
```

3. ビルド:
```bash
npm run build
```

4. テスト実行:
```bash
npm test
```

## 実装パターン一覧

### 生成パターン（Creational Patterns）
- [x] Singleton - シングルトンパターン
- [x] Factory Method - ファクトリーメソッドパターン
- [x] Abstract Factory - 抽象ファクトリーパターン
- [x] Builder - ビルダーパターン
- [x] Prototype - プロトタイプパターン（文書管理システム実装）

### 構造パターン（Structural Patterns）
- [x] Adapter - アダプターパターン（レガシーシステムとモダンなシステム間のデータ変換）
- [x] Bridge - ブリッジパターン（デバイス制御システムの実装）
- [x] Composite - コンポジットパターン（ファイルシステム実装）
- [x] Decorator - デコレーターパターン（データ処理の拡張実装）
- [x] Facade - ファサードパターン（ビデオ変換システム実装）
- [x] Flyweight - フライウェイトパターン（テキストフォーマット共有実装）
- [x] Proxy - プロキシパターン（画像ギャラリーの遅延読み込み実装）

### 振る舞いパターン（Behavioral Patterns）
- [x] Chain of Responsibility - 責任の連鎖パターン（サポートチケットシステム実装）
- [x] Command - コマンドパターン（スマートホームデバイス制御システム実装）
- [x] Interpreter - インタープリターパターン（数式解析・評価システム実装）
- [x] Iterator - イテレーターパターン（音楽プレイリストシステム実装）
- [x] Mediator - メディエーターパターン（チャットルームシステム実装）
- [x] Memento - メメントパターン（テキストエディタシステム実装）
- [x] Observer - オブザーバーパターン（天気観測システム実装）
- [x] State - ステートパターン（自動販売機システム実装）
- [x] Strategy - ストラテジーパターン（支払い処理システム実装）
- [x] Template Method - テンプレートメソッドパターン（データ解析システム実装）
- [x] Visitor - ビジターパターン（ファイルシステム要素の操作実装）

## 実装済みパターンの詳細

### シングルトンパターン
- グローバルな状態管理を実現
- スレッドセーフな実装
- 遅延初期化（Lazy Initialization）対応

### ファクトリーメソッドパターン
- 製品の生成を柔軟に実装
- 具象クラスの依存関係を最小限に抑制
- 拡張性の高い設計を実現

### 抽象ファクトリーパターン
- 関連する一連のオブジェクトを一貫性を持って生成
- 製品ファミリーの切り替えを容易に実現
- インターフェースベースの設計

### ビルダーパターン
- 複雑なオブジェクトの段階的な生成
- 生成過程と表現を分離
- メソッドチェーンによる直感的なAPI

### プロトタイプパターン（文書管理システム）
文書のテンプレートを作成し、それをクローンして新しい文書を効率的に生成するシステムを実装しています。

#### 主な機能
- 文書の基本テンプレート（DocumentPrototype）
  - タイトル、内容、作成者の管理
  - メタデータの柔軟な追加・管理
  - ディープコピーによる安全なクローン生成
- 報告書テンプレート（Report）
  - 部署情報の管理
  - メタデータの自動設定
  - カスタマイズ可能な報告書フォーマット
- 契約書テンプレート（Contract）
  - 契約当事者の管理
  - 有効期限の設定
  - メタデータの自動設定
  - 法的要件に対応した契約書フォーマット

#### 特徴
- TypeScriptの型システムを活用した安全な実装
- メタデータの柔軟な管理
- 作成日時の適切な更新処理
- 完全なテストカバレッジ
- 拡張性の高い設計
- ユーザーフレンドリーなAPI

#### 実装のポイント
- クローン時の深いコピー
- メタデータの適切な複製
- 作成日時の自動更新
- 型安全性の確保
- エラーハンドリング

### アダプターパターン
レガシーシステムとモダンなシステム間のデータ変換を実現するアダプターを実装しています。

#### 主な機能
- レガシーデータとモダンなデータの相互変換
  - 識別子の形式変換（数値 ⇔ 文字列）
  - メタデータの管理（作成日時、更新日時、バージョン）
  - オブジェクト型の値の適切な変換（JSON形式）
- エラーハンドリング
  - 無効な識別子の検証
  - データ型変換時のエラー処理
  - 存在しないデータの処理
- 非同期処理対応
  - Promise型を使用した非同期データ処理
  - モダンなインターフェースの提供

#### 特徴
- TypeScriptの型システムを活用した安全な実装
- インターフェースによる契約の定義
- 完全なテストカバレッジ
- エラーハンドリングの充実
- 拡張性の高い設計

#### 実装のポイント
- データ変換の双方向対応
- 型安全性の確保
- エラー処理の統一
- 非同期処理の適切な実装
- テストの網羅性

### ブリッジパターン
デバイス制御システムを実装し、抽象化（リモコン）と実装（デバイス）を分離することで、両者を独立して変更可能にしています。

#### 主な機能
- デバイスの基本操作
  - 電源のオン/オフ
  - 音量調整
  - チャンネル切り替え
- 高度なリモコン機能
  - ミュート機能
  - チャンネルの直接指定
  - 前のチャンネルに戻る機能
- デバイス実装
  - テレビ
  - ラジオ

#### 特徴
- TypeScriptの型システムを活用した安全な実装
- デバイスと制御機能の独立した拡張が可能
- 完全なテストカバレッジ
- エラーハンドリングの充実
- 拡張性の高い設計

#### 実装のポイント
- 抽象化と実装の分離
- デバイス固有の動作の適切な実装
- 共通インターフェースの定義
- エラー処理の統一
- テストの網羅性

### Composite Pattern ✅
ファイルシステムを例にしたコンポジットパターンの実装。
- `FileSystemComponent`インターフェースで共通の操作を定義
- `File`クラス（リーフ）でファイルを表現
- `Directory`クラス（コンポジット）でディレクトリを表現
- 再帰的な構造でファイルシステムの階層を管理
- サイズ計算、作成日時、更新日時などの管理
- ツリー構造の視覚的な表示

主な機能：
- ファイルとディレクトリの作成
- コンポーネントの追加と削除
- ファイルサイズの更新
- 階層構造の表示
- 総サイズの計算

テスト結果：
- 全11テストが成功
- カバレッジ：
  - 文: 90.41%
  - 分岐: 90.9%
  - 関数: 84.61%

### Decorator Pattern ✅
データの読み書きに追加機能を動的に付与するデコレーターパターンの実装。
- `DataSource`インターフェースで基本操作を定義
- `FileDataSource`クラスで基本的なファイル操作を実装
- `EncryptionDecorator`で暗号化機能を追加
- `CompressionDecorator`で圧縮機能を追加
- デコレーターの柔軟な組み合わせが可能

主な機能：
- ファイルへのデータの読み書き
- AES-256-CBCによる暗号化/復号化
- zlib圧縮/解凍
- 複数のデコレーターの組み合わせ
- エラーハンドリング

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 84.84%
  - 分岐: 50%
  - 関数: 100%
  - 行: 84.84%

### Facade Pattern ✅
ビデオ変換システムを例にしたファサードパターンの実装。
- `VideoConverter`ファサードで複雑なサブシステムを隠蔽
- `VideoFile`でビデオファイルのメタデータを管理
- `CodecFactory`でコーデックの生成を担当
- `BitrateReader`でビデオデータの読み取りと変換を実行
- `AudioMixer`でオーディオ処理を実行

主な機能：
- 異なるフォーマット間のビデオ変換
- コーデック自動選択
- ビデオデータの読み取りと変換
- オーディオトラックの処理
- 複数のサブシステムの統合

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 89.23%
  - 分岐: 100%
  - 関数: 76.19%
  - 行: 89.23%

### Flyweight Pattern ✅
テキストエディタを例にしたフライウェイトパターンの実装。
- `TextFormat`インターフェースで共有可能な属性を定義
- `ConcreteTextFormat`で共有可能な内部状態を実装
- `TextFormatFactory`でフライウェイトオブジェクトを管理
- `FormattedText`で外部状態（コンテキスト）を管理
- `TextEditor`でクライアント操作を提供

主な機能：
- テキストフォーマットの共有と再利用
- メモリ使用量の最適化
- フォーマット検索
- スタイルの柔軟な組み合わせ
- メモリ使用状況の追跡

テスト結果：
- 全9テストが成功
- カバレッジ：
  - 文: 100%
  - 分岐: 83.33%
  - 関数: 100%
  - 行: 100%

### Proxy Pattern ✅
画像ギャラリーを例にしたプロキシパターンの実装。
- `Image`インターフェースで画像の基本操作を定義
- `RealImage`クラスで実際の画像の読み込みと表示を実装
- `ProxyImage`クラスで遅延読み込みを実現
- `ImageGallery`クラスで画像の管理と表示を制御
- メモリ使用量の最適化

主な機能：
- 画像の遅延読み込み
- メタデータの即時読み込み
- 画像の表示と情報表示
- ギャラリー情報の管理
- メモリ使用量の監視

テスト結果：
- 全10テストが成功
- カバレッジ：
  - 文: 97.77%
  - 分岐: 100%
  - 関数: 92%
  - 行: 97.77%

### Chain of Responsibility Pattern ✅
サポートチケットシステムを例にした責任の連鎖パターンの実装。
- `Handler`インターフェースでチケット処理の基本操作を定義
- `AbstractHandler`で基本的な連鎖処理を実装
- 3段階のサポートレベル（一次、二次、エスカレーション）を実装
- 優先度とカテゴリに基づく処理の振り分け
- 緊急時の特別対応プロトコル

主な機能：
- チケットの優先度に基づく処理
- カテゴリ別の専門的な対応
- 処理できない場合の自動転送
- 緊急時の特別対応
- エラーハンドリング

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 98.21%
  - 分岐: 100%
  - 関数: 93.75%
  - 行: 98.21%

### Command Pattern ✅
スマートホームデバイス制御システムを例にしたコマンドパターンの実装。
- `Command`インターフェースでコマンドの基本操作を定義
- `LightCommand`クラスでライトのオン/オフを実装
- `FanCommand`クラスでファンの速度を実装
- `CommandExecutor`でコマンドの実行を実装

主な機能：
- コマンドの実行と履歴の管理
- 異なるデバイスの制御
- コマンドのパラメータの管理
- エラーハンドリング

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 98.21%
  - 分岐: 100%
  - 関数: 93.75%
  - 行: 98.21%

### Interpreter Pattern ✅
数式の解析と評価を例にしたInterpreterパターンの実装。
- `Expression`インターフェースで式の評価を定義
- `Context`クラスで変数の管理を実装
- 終端式（数値、変数）と非終端式（演算子）を実装
- `ExpressionParser`で式の解析を実装

主な機能：
- 四則演算の解析と評価
- 変数の管理と参照
- 括弧による優先順位の制御
- エラー処理と診断メッセージ

テスト結果：
- 全13テストが成功
- カバレッジ：
  - 文: 93.33%
  - 分岐: 77.77%
  - 関数: 100%
  - 行: 93.26%

### Iterator Pattern ✅
音楽プレイリストシステムを例にしたイテレーターパターンの実装。
- `Iterator`インターフェースで走査操作を定義
- `Aggregate`インターフェースでイテレーター生成を定義
- `Playlist`クラスで音楽プレイリストを実装
- `PlaylistIterator`で通常の順序での走査を実装
- シャッフル再生機能も実装

主な機能：
- プレイリストの作成と管理
- 曲の追加と削除
- 順序通りの再生
- シャッフル再生
- エラーハンドリング

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 95.65%
  - 分岐: 66.66%
  - 関数: 100%
  - 行: 95.23%

### Mediator Pattern ✅
チャットルームシステムを例にしたメディエーターパターンの実装。
- `ChatMediator`インターフェースでユーザー間の通信を仲介
- `ChatUser`基底クラスでユーザーの基本機能を定義
- `RegularUser`と`AdminUser`で異なるユーザー権限を実装
- `ChatRoom`でメッセージの配信制御を実装
- 4種類のメッセージタイプをサポート

主な機能：
- ユーザーの参加と退出管理
- 通常メッセージの配信
- プライベートメッセージの送受信
- システムメッセージの配信
- ユーザーステータスの管理
- メッセージ履歴の管理

テスト結果：
- 全11テストが成功
- カバレッジ：
  - 文: 92.7%
  - 分岐: 86.66%
  - 関数: 90.62%
  - 行: 93.4%

### Memento Pattern ✅
テキストエディタを例にしたメメントパターンの実装。
- `TextEditor`クラスでテキスト編集機能を提供
- `EditorMemento`クラスでエディタの状態を保存
- `EditorHistory`クラスで履歴管理を実装
- カーソル位置と選択範囲の管理

主な機能：
- テキストの編集と保存
- カーソル位置の管理
- テキスト選択機能
- 状態の保存と復元
- Undo/Redo機能
- 履歴の分岐管理

テスト結果：
- 全16テストが成功
- カバレッジ：
  - 文: 100%
  - 分岐: 100%
  - 関数: 100%
  - 行: 100%

### Observer Pattern ✅
天気観測システムを例にしたオブザーバーパターンの実装。
- `WeatherStation`クラスで気象データの管理と通知を実装
- `Observer`インターフェースで更新通知の受信を定義
- 3種類のディスプレイを実装
  - 現在の気象状況表示
  - 統計情報表示
  - 天気予報表示

主な機能：
- 気象データの測定と通知
- オブザーバーの登録と削除
- 複数の表示形式
- 統計データの管理
- 天気予報の生成
- リアルタイムな表示更新

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 100%
  - 分岐: 100%
  - 関数: 100%
  - 行: 100%

### State Pattern ✅
自動販売機を例にしたステートパターンの実装。
- `VendingMachineState`インターフェースで状態に応じた振る舞いを定義
- 3つの状態を実装
  - `NoMoneyState`: お金が投入されていない状態
  - `HasMoneyState`: お金が投入された状態
  - `ProductSelectedState`: 商品が選択された状態
- 状態に応じた適切な振る舞いの制御

主な機能：
- 商品の在庫管理
- 投入金額の管理
- 商品の選択と購入
- お釣りの返却
- 状態に応じた操作の制限
- エラー処理

テスト結果：
- 全16テストが成功
- カバレッジ：
  - 文: 95.58%
  - 分岐: 71.42%
  - 関数: 96.66%
  - 行: 95.58%

### Strategy Pattern ✅
支払い処理システムを例にしたストラテジーパターンの実装。
- `PaymentStrategy`インターフェースで支払い方法を定義
- 3つの支払い方法を実装
  - `CreditCardPayment`: クレジットカード決済
  - `PayPalPayment`: PayPal決済
  - `BankTransferPayment`: 銀行振込
- 実行時に支払い方法を切り替え可能

主な機能：
- 複数の支払い方法の管理
- 支払い処理の実行
- 支払い履歴の管理
- エラー処理
- 支払い情報のフォーマット

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 93.47%
  - 分岐: 81.25%
  - 関数: 93.33%
  - 行: 93.47%

### Template Method Pattern ✅
データ解析システムを例にしたTemplate Methodパターンの実装。
- `DataMiner`抽象クラスでデータ解析の基本フローを定義
- 2つの具象クラスを実装
  - `CSVDataMiner`: CSVファイルの解析
  - `JSONDataMiner`: JSONファイルの解析
- フックメソッドによる柔軟なカスタマイズ

主な機能：
- 異なる形式のデータ解析
- データのクリーニング
- 統計情報の計算
- 洞察の生成
- キャッシュ機能
- エラーハンドリング

テスト結果：
- 全8テストが成功
- カバレッジ：
  - 文: 90.96%
  - 分岐: 78.94%
  - 関数: 90.56%
  - 行: 90.13%

実装の特徴：
1. テンプレートメソッド（`mine`）で解析の流れを定義
2. 抽象メソッド：
   - `readData`: データの読み込み
   - `cleanData`: データのクリーニング
   - `analyzeData`: データの解析
3. フックメソッド：
   - `shouldCache`: キャッシュの有効/無効
   - `cacheResult`: 結果のキャッシュ
   - `generateInsights`: 洞察の生成
4. 共通機能：
   - データ形式に依存しない統一的なインターフェース
   - エラーハンドリングとログ出力
   - キャッシュによるパフォーマンス最適化

次回の改善点：
- より詳細な統計情報の追加
- 並列処理への対応
- メモリ使用量の最適化
- プラグイン機能の追加

### Visitor Pattern ✅
ファイルシステム要素の操作を実装したVisitorパターン。

主な機能：
- サイズ計算Visitor
  - ファイルシステム要素のサイズを計算
  - ディレクトリの再帰的なサイズ計算
  - 詳細なサイズ情報の管理
- ファイル検索Visitor
  - 名前、サイズ、日時による検索
  - 柔軟な検索条件の組み合わせ
  - 検索結果の管理
- 構造視覚化Visitor
  - ファイルシステムの階層構造を視覚化
  - 適切なアイコンとインデントの表示
  - 空ディレクトリの特別表示

特徴：
- 新しい操作の追加が容易
- 既存のコードを変更せずに機能拡張が可能
- TypeScriptの型システムを活用した安全な実装
- 完全なテストカバレッジ
- エラーハンドリングの充実

テスト結果：
- 全テストが成功
- カバレッジ：
  - 文: 95%以上
  - 分岐: 90%以上
  - 関数: 100%

## 今後の実装予定
すべてのデザインパターンの実装が完了しました！

今後の改善点：
- より詳細なドキュメントの作成
- パフォーマンスの最適化
- より実践的なユースケースの追加
- テストカバレッジの向上
- コードの品質向上

## ドキュメント

各デザインパターンの詳細な説明とサンプルコードは `docs` ディレクトリを参照してください。
特に、`docs/System-design/specification.md` には各パターンの詳細な実装仕様が記載されています。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルを参照してください。
