# Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ - ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã®å®Ÿè£…

## æ¦‚è¦

Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ãã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹æ“ä½œã‚’åˆ†é›¢ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ“ä½œï¼ˆæ¤œç´¢ã€ã‚µã‚¤ã‚ºè¨ˆç®—ã€æ§‹é€ è¦–è¦šåŒ–ï¼‰ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸»ãªç›®çš„ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š
- ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨æ“ä½œã®åˆ†é›¢
- æ–°ã—ã„æ“ä½œã®å®¹æ˜“ãªè¿½åŠ 
- ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å¤‰æ›´ã‚’æœ€å°é™ã«æŠ‘åˆ¶

### ä¸»ãªç”¨é€”
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ¢ç´¢ã¨æ“ä½œ
- è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å‡¦ç†
- ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- ãƒ‡ãƒ¼ã‚¿è§£æ

## ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ

### 1. åŸºæœ¬æ§‹æˆ
ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã®ãŸã‚ã®Visitorãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§æ§‹æˆã•ã‚Œã¾ã™ï¼š

- **FileSystemVisitor**ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã‚’è¨ªå•ã™ã‚‹Visitorã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **FileSystemElement**ï¼šåŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **FileSystemComponent**ï¼šVisitorã‚’å—ã‘å…¥ã‚Œã‚‹æ©Ÿèƒ½ã‚’æŒã¤ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **å…·è±¡è¦ç´ ã‚¯ãƒ©ã‚¹**ï¼šFileã€Directoryã€SymbolicLinkãªã©ã®å…·ä½“çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ 
- **å…·è±¡Visitorã‚¯ãƒ©ã‚¹**ï¼šFileSearcherã€SizeCalculatorã€FileStructureVisualizerãªã©ã®ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†Visitor

### 2. ã‚¯ãƒ©ã‚¹æ§‹é€ 
ä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¹å›³ã¯ã€Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã®æ§‹é€ ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

```mermaid
classDiagram
    class FileSystemElement {
        <<interface>>
        +getName() string
        +getPath() string
        +getSize() number
        +getCreatedAt() Date
        +getModifiedAt() Date
    }
    
    class FileSystemComponent {
        <<interface>>
        +accept(visitor: FileSystemVisitor) void
        +getParent() FileSystemComponent
        +setParent(parent: FileSystemComponent) void
    }
    
    class FileSystemVisitor {
        <<interface>>
        +visitFile(file: File) void
        +visitDirectory(directory: Directory) void
        +visitSymbolicLink(symlink: SymbolicLink) void
        +getResult() any
    }
    
    class File {
        -name: string
        -path: string
        -size: number
        -createdAt: Date
        -modifiedAt: Date
        -parent: FileSystemComponent
        +accept(visitor: FileSystemVisitor) void
        +getName() string
        +getPath() string
        +getSize() number
        +getCreatedAt() Date
        +getModifiedAt() Date
        +getParent() FileSystemComponent
        +setParent(parent: FileSystemComponent) void
    }
    
    class Directory {
        -name: string
        -path: string
        -createdAt: Date
        -modifiedAt: Date
        -children: FileSystemComponent[]
        -parent: FileSystemComponent
        +accept(visitor: FileSystemVisitor) void
        +getName() string
        +getPath() string
        +getSize() number
        +getCreatedAt() Date
        +getModifiedAt() Date
        +getParent() FileSystemComponent
        +setParent(parent: FileSystemComponent) void
        +add(element: FileSystemComponent) void
        +remove(element: FileSystemComponent) boolean
        +getChildren() FileSystemComponent[]
        +isEmpty() boolean
    }
    
    class SymbolicLink {
        -name: string
        -path: string
        -target: FileSystemComponent
        -createdAt: Date
        -modifiedAt: Date
        -parent: FileSystemComponent
        +accept(visitor: FileSystemVisitor) void
        +getName() string
        +getPath() string
        +getSize() number
        +getCreatedAt() Date
        +getModifiedAt() Date
        +getParent() FileSystemComponent
        +setParent(parent: FileSystemComponent) void
        +getTarget() FileSystemComponent
        +getTargetPath() string
        +isValid() boolean
    }
    
    class FileSearcher {
        -searchCriteria: SearchCriteria
        -foundFiles: File[]
        +visitFile(file: File) void
        +visitDirectory(directory: Directory) void
        +visitSymbolicLink(symlink: SymbolicLink) void
        +getResult() File[]
        +setSearchCriteria(criteria: SearchCriteria) void
        +resetResults() void
    }
    
    class SizeCalculator {
        -totalSize: number
        -sizeFormat: SizeFormat
        +visitFile(file: File) void
        +visitDirectory(directory: Directory) void
        +visitSymbolicLink(symlink: SymbolicLink) void
        +getResult() string
        +setSizeFormat(format: SizeFormat) void
        +resetTotalSize() void
    }
    
    class FileStructureVisualizer {
        -structure: string
        -indentLevel: number
        -indentSize: number
        +visitFile(file: File) void
        +visitDirectory(directory: Directory) void
        +visitSymbolicLink(symlink: SymbolicLink) void
        +getResult() string
        +setIndentSize(size: number) void
        +resetStructure() void
    }
    
    FileSystemElement <|-- FileSystemComponent
    FileSystemComponent <|.. File
    FileSystemComponent <|.. Directory
    FileSystemComponent <|.. SymbolicLink
    
    FileSystemVisitor <|.. FileSearcher
    FileSystemVisitor <|.. SizeCalculator
    FileSystemVisitor <|.. FileStructureVisualizer
    
    FileSystemVisitor ..> File : visits
    FileSystemVisitor ..> Directory : visits
    FileSystemVisitor ..> SymbolicLink : visits
    
    File ..> FileSystemVisitor : accepts
    Directory ..> FileSystemVisitor : accepts
    SymbolicLink ..> FileSystemVisitor : accepts
    
    Directory o-- FileSystemComponent : contains
    SymbolicLink --> FileSystemComponent : references
```

ã“ã®ã‚¯ãƒ©ã‚¹å›³ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªé–¢ä¿‚ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

1. **FileSystemElement**ã¯åŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚
2. **FileSystemComponent**ã¯FileSystemElementã‚’ç¶™æ‰¿ã—ã€Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®acceptãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚
3. **File**ã€**Directory**ã€**SymbolicLink**ã¯FileSystemComponentã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ãŸå…·è±¡ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
4. **FileSystemVisitor**ã¯Visitorã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã€å„è¦ç´ ã‚¿ã‚¤ãƒ—ã«å¯¾ã™ã‚‹è¨ªå•ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
5. **FileSearcher**ã€**SizeCalculator**ã€**FileStructureVisualizer**ã¯FileSystemVisitorã‚’å®Ÿè£…ã—ãŸå…·è±¡ã‚¯ãƒ©ã‚¹ã§ã€ç‰¹å®šã®æ“ä½œã‚’è¡Œã„ã¾ã™ã€‚
6. **Directory**ã¯å­è¦ç´ ã¨ã—ã¦FileSystemComponentã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒã¡ã¾ã™ï¼ˆCompositeãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã€‚
7. **SymbolicLink**ã¯ä»–ã®FileSystemComponentã¸ã®å‚ç…§ã‚’æŒã¡ã¾ã™ã€‚

### 3. å‡¦ç†ãƒ•ãƒ­ãƒ¼

#### 3.1 ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ•ãƒ­ãƒ¼
```mermaid
flowchart TD
    A[é–‹å§‹] --> B{æ¤œç´¢æ¡ä»¶ã®æ¤œè¨¼}
    B -->|æœ‰åŠ¹| C[FileSearcherç”Ÿæˆ]
    B -->|ç„¡åŠ¹| D[ã‚¨ãƒ©ãƒ¼å‡¦ç†]
    C --> E[ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¢ç´¢é–‹å§‹]
    E --> F{è¦ç´ ã®ç¨®é¡åˆ¤å®š}
    F -->|ãƒ•ã‚¡ã‚¤ãƒ«| G[ãƒ•ã‚¡ã‚¤ãƒ«æ¡ä»¶ãƒã‚§ãƒƒã‚¯]
    F -->|ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª| H[ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¡ä»¶ãƒã‚§ãƒƒã‚¯]
    F -->|ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯| I[ãƒªãƒ³ã‚¯æ¡ä»¶ãƒã‚§ãƒƒã‚¯]
    G --> J{æ¡ä»¶ä¸€è‡´?}
    H --> J
    I --> J
    J -->|ã¯ã„| K[çµæœã«è¿½åŠ ]
    J -->|ã„ã„ãˆ| L[æ¬¡ã®è¦ç´ ã¸]
    K --> L
    L --> M{ã™ã¹ã¦ã®è¦ç´ ã‚’å‡¦ç†?}
    M -->|ã„ã„ãˆ| F
    M -->|ã¯ã„| N[çµæœã‚’è¿”å´]
    N --> O[çµ‚äº†]
    D --> O
```

ã“ã®ãƒ•ãƒ­ãƒ¼å›³ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ã®å‡¦ç†æ‰‹é †ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

1. **å‰å‡¦ç†ãƒ•ã‚§ãƒ¼ã‚º**
   - æ¤œç´¢æ¡ä»¶ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼
     - åå‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ‰åŠ¹æ€§
     - ã‚µã‚¤ã‚ºç¯„å›²ã®æ•´åˆæ€§
     - æ—¥æ™‚ç¯„å›²ã®æ•´åˆæ€§
   - ç„¡åŠ¹ãªæ¡ä»¶ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼å‡¦ç†

2. **åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º**
   - FileSearcherã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆ
   - å†…éƒ¨çŠ¶æ…‹ã®åˆæœŸåŒ–
   - æ¢ç´¢æº–å‚™ã®å®Œäº†

3. **æ¢ç´¢ãƒ•ã‚§ãƒ¼ã‚º**
   - è¦ç´ ã®ç¨®é¡ã«å¿œã˜ãŸå‡¦ç†åˆ†å²
     - ãƒ•ã‚¡ã‚¤ãƒ«ï¼šåå‰ã€ã‚µã‚¤ã‚ºã€æ—¥æ™‚ã®æ¡ä»¶ãƒã‚§ãƒƒã‚¯
     - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼šåå‰ã¨å±æ€§ã®æ¡ä»¶ãƒã‚§ãƒƒã‚¯
     - ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ï¼šãƒªãƒ³ã‚¯åã¨å‚ç…§å…ˆã®æ¡ä»¶ãƒã‚§ãƒƒã‚¯
   - æ¡ä»¶ä¸€è‡´æ™‚ã®çµæœè¿½åŠ 
   - æ¬¡ã®è¦ç´ ã¸ã®ç§»å‹•

4. **çµ‚äº†ãƒ•ã‚§ãƒ¼ã‚º**
   - ã™ã¹ã¦ã®è¦ç´ ã®å‡¦ç†å®Œäº†ç¢ºèª
   - çµæœã®è¿”å´
   - ãƒªã‚½ãƒ¼ã‚¹ã®è§£æ”¾

#### 3.2 ã‚µã‚¤ã‚ºè¨ˆç®—ãƒ•ãƒ­ãƒ¼
```mermaid
flowchart TD
    A[é–‹å§‹] --> B[SizeCalculatorç”Ÿæˆ]
    B --> C[ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‡¦ç†é–‹å§‹]
    C --> D{è¦ç´ ã®ç¨®é¡åˆ¤å®š}
    D -->|ãƒ•ã‚¡ã‚¤ãƒ«| E[ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºå–å¾—]
    D -->|ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª| F[ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‡¦ç†é–‹å§‹]
    D -->|ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯| G[ãƒªãƒ³ã‚¯ã‚µã‚¤ã‚ºå–å¾—]
    E --> H[åˆè¨ˆã«åŠ ç®—]
    G --> H
    F --> I[å­è¦ç´ ã®åˆ—æŒ™]
    I --> J{å­è¦ç´ ã‚ã‚Š?}
    J -->|ã¯ã„| K[å­è¦ç´ ã‚’å‡¦ç†]
    J -->|ã„ã„ãˆ| L[ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µã‚¤ã‚ºè¨ˆç®—]
    K --> D
    L --> H
    H --> M{ã™ã¹ã¦ã®è¦ç´ ã‚’å‡¦ç†?}
    M -->|ã„ã„ãˆ| D
    M -->|ã¯ã„| N[åˆè¨ˆã‚µã‚¤ã‚ºã‚’è¿”å´]
    N --> O[çµ‚äº†]
```

ã“ã®ãƒ•ãƒ­ãƒ¼å›³ã¯ã€ã‚µã‚¤ã‚ºè¨ˆç®—ã®å‡¦ç†æ‰‹é †ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

1. **åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º**
   - SizeCalculatorã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆ
   - åˆè¨ˆã‚µã‚¤ã‚ºã®åˆæœŸåŒ–
   - ã‚µã‚¤ã‚ºè©³ç´°ãƒãƒƒãƒ—ã®æº–å‚™

2. **è¨ˆç®—ãƒ•ã‚§ãƒ¼ã‚º**
   - è¦ç´ ã®ç¨®é¡ã«å¿œã˜ãŸå‡¦ç†
     - ãƒ•ã‚¡ã‚¤ãƒ«ï¼šç›´æ¥ã‚µã‚¤ã‚ºã‚’å–å¾—ã—ã¦åŠ ç®—
     - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼šå­è¦ç´ ã‚’å†å¸°çš„ã«å‡¦ç†
     - ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ï¼šãƒªãƒ³ã‚¯è‡ªä½“ã®ã‚µã‚¤ã‚ºã‚’åŠ ç®—
   - å„è¦ç´ ã®ã‚µã‚¤ã‚ºã‚’è©³ç´°ãƒãƒƒãƒ—ã«è¨˜éŒ²

3. **é›†è¨ˆãƒ•ã‚§ãƒ¼ã‚º**
   - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆã¯å­è¦ç´ ã®ã‚µã‚¤ã‚ºã‚’åˆç®—
   - åˆè¨ˆã‚µã‚¤ã‚ºã®æ›´æ–°
   - ãƒ‘ã‚¹ã”ã¨ã®ã‚µã‚¤ã‚ºæƒ…å ±ã®ç®¡ç†

4. **çµ‚äº†ãƒ•ã‚§ãƒ¼ã‚º**
   - ã™ã¹ã¦ã®è¦ç´ ã®å‡¦ç†å®Œäº†ç¢ºèª
   - æœ€çµ‚çš„ãªåˆè¨ˆã‚µã‚¤ã‚ºã®è¨ˆç®—
   - çµæœã®è¿”å´

#### 3.3 æ§‹é€ è¦–è¦šåŒ–ãƒ•ãƒ­ãƒ¼
```mermaid
flowchart TD
    A[é–‹å§‹] --> B[FileStructureVisualizerç”Ÿæˆ]
    B --> C[ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºè¨­å®š]
    C --> D[ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‡¦ç†é–‹å§‹]
    D --> E{è¦ç´ ã®ç¨®é¡åˆ¤å®š}
    E -->|ãƒ•ã‚¡ã‚¤ãƒ«| F[ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ]
    E -->|ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª| G[ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‡¦ç†é–‹å§‹]
    E -->|ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯| H[ãƒªãƒ³ã‚¯æƒ…å ±ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ]
    F --> I[ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆä»˜ä¸]
    H --> I
    G --> J[ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæƒ…å ±è¿½åŠ ]
    J --> K{ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª?}
    K -->|ã¯ã„| L[ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¡¨ç¤º]
    K -->|ã„ã„ãˆ| M[å­è¦ç´ ã®åˆ—æŒ™]
    L --> I
    M --> N{å­è¦ç´ ã‚ã‚Š?}
    N -->|ã¯ã„| O[ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«å¢—åŠ ]
    N -->|ã„ã„ãˆ| P[çµæœæ–‡å­—åˆ—ã®æ•´å½¢]
    O --> Q[å­è¦ç´ ã‚’å‡¦ç†]
    Q --> E
    I --> R{ã™ã¹ã¦ã®è¦ç´ ã‚’å‡¦ç†?}
    R -->|ã„ã„ãˆ| E
    R -->|ã¯ã„| P
    P --> S[çµ‚äº†]
```

ã“ã®ãƒ•ãƒ­ãƒ¼å›³ã¯ã€æ§‹é€ è¦–è¦šåŒ–ã®å‡¦ç†æ‰‹é †ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

1. **åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º**
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒFileStructureVisualizerã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
   - ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’è¨­å®š
   - çµæœæ–‡å­—åˆ—ãƒãƒƒãƒ•ã‚¡ã‚’åˆæœŸåŒ–

2. **è¦–è¦šåŒ–ãƒ•ã‚§ãƒ¼ã‚º**
   - è¦ç´ ã®ç¨®é¡ã«å¿œã˜ãŸå‡¦ç†
     - ãƒ•ã‚¡ã‚¤ãƒ«ï¼šğŸ“„ã‚¢ã‚¤ã‚³ãƒ³ã¨æƒ…å ±ã‚’è¿½åŠ 
     - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼šğŸ“ã‚¢ã‚¤ã‚³ãƒ³ã¨æƒ…å ±ã‚’è¿½åŠ 
     - ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ï¼šğŸ”—ã‚¢ã‚¤ã‚³ãƒ³ã¨æƒ…å ±ã‚’è¿½åŠ 
   - ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã®ç®¡ç†
   - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç‰¹åˆ¥å‡¦ç†

3. **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ•ã‚§ãƒ¼ã‚º**
   - é©åˆ‡ãªã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®ä»˜ä¸
   - ã‚¢ã‚¤ã‚³ãƒ³ã¨æƒ…å ±ã®é…ç½®
   - æ”¹è¡Œã®æŒ¿å…¥

4. **çµ‚äº†ãƒ•ã‚§ãƒ¼ã‚º**
   - ã™ã¹ã¦ã®è¦ç´ ã®å‡¦ç†å®Œäº†ç¢ºèª
   - çµæœæ–‡å­—åˆ—ã®æœ€çµ‚æ•´å½¢
   - ä½™åˆ†ãªæ”¹è¡Œã®å‰Šé™¤ 

### 4. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

#### 4.1 ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ—ãƒ­ã‚»ã‚¹
```mermaid
sequenceDiagram
    participant Client
    participant FileSearcher
    participant Directory
    participant File
    participant SymbolicLink
    
    Note over Client,SymbolicLink: åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º
    Client->>FileSearcher: new FileSearcher(criteria)
    
    Note over Client,SymbolicLink: æ¢ç´¢ãƒ•ã‚§ãƒ¼ã‚º
    Client->>Directory: accept(searcher)
    activate Directory
    Directory->>FileSearcher: visitDirectory(this)
    activate FileSearcher
    FileSearcher->>FileSearcher: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæƒ…å ±ã‚’è¨˜éŒ²
    FileSearcher-->>Directory: å­è¦ç´ ã®å‡¦ç†ã‚’è¦æ±‚
    deactivate FileSearcher
    
    Note over Directory,SymbolicLink: å­è¦ç´ ã®æ¢ç´¢
    Directory->>File: accept(searcher)
    activate File
    File->>FileSearcher: visitFile(this)
    activate FileSearcher
    FileSearcher->>FileSearcher: matchesCriteria(file)
    Note right of FileSearcher: æ¡ä»¶ã«ä¸€è‡´ã—ãŸã‚‰çµæœã«è¿½åŠ 
    FileSearcher-->>File: å‡¦ç†å®Œäº†
    deactivate FileSearcher
    File-->>Directory: å‡¦ç†å®Œäº†
    deactivate File
    
    Directory->>SymbolicLink: accept(searcher)
    activate SymbolicLink
    SymbolicLink->>FileSearcher: visitSymbolicLink(this)
    activate FileSearcher
    FileSearcher->>FileSearcher: matchesCriteria(link)
    Note right of FileSearcher: æ¡ä»¶ã«ä¸€è‡´ã—ãŸã‚‰çµæœã«è¿½åŠ 
    FileSearcher-->>SymbolicLink: å‡¦ç†å®Œäº†
    deactivate FileSearcher
    SymbolicLink-->>Directory: å‡¦ç†å®Œäº†
    deactivate SymbolicLink
    
    Note over Directory,File: å†å¸°çš„æ¢ç´¢
    Directory->>Directory: å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
    Directory->>Directory: accept(searcher) [å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¯¾ã—ã¦]
    Note right of Directory: å†å¸°çš„ã«å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¢ç´¢
    
    Directory-->>Client: æ¢ç´¢å®Œäº†
    deactivate Directory
    
    Note over Client,SymbolicLink: çµæœå–å¾—ãƒ•ã‚§ãƒ¼ã‚º
    Client->>FileSearcher: getResult()
    activate FileSearcher
    FileSearcher-->>Client: æ¤œç´¢çµæœã®é…åˆ—
    deactivate FileSearcher
```

#### 4.2 ã‚µã‚¤ã‚ºè¨ˆç®—ãƒ—ãƒ­ã‚»ã‚¹
```mermaid
sequenceDiagram
    participant Client
    participant SizeCalculator
    participant Directory
    participant File
    participant SymbolicLink
    
    Note over Client,SymbolicLink: åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º
    Client->>SizeCalculator: new SizeCalculator()
    
    Note over Client,SymbolicLink: è¨ˆç®—ãƒ•ã‚§ãƒ¼ã‚º
    Client->>Directory: accept(calculator)
    activate Directory
    Directory->>SizeCalculator: visitDirectory(this)
    activate SizeCalculator
    SizeCalculator->>SizeCalculator: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µã‚¤ã‚ºã‚’åˆæœŸåŒ–
    SizeCalculator-->>Directory: å­è¦ç´ ã®å‡¦ç†ã‚’è¦æ±‚
    deactivate SizeCalculator
    
    Note over Directory,SymbolicLink: å­è¦ç´ ã®ã‚µã‚¤ã‚ºè¨ˆç®—
    Directory->>File: accept(calculator)
    activate File
    File->>SizeCalculator: visitFile(this)
    activate SizeCalculator
    SizeCalculator->>SizeCalculator: totalSize += file.size
    Note right of SizeCalculator: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’åˆè¨ˆã«åŠ ç®—
    SizeCalculator-->>File: å‡¦ç†å®Œäº†
    deactivate SizeCalculator
    File-->>Directory: å‡¦ç†å®Œäº†
    deactivate File
    
    Directory->>SymbolicLink: accept(calculator)
    activate SymbolicLink
    SymbolicLink->>SizeCalculator: visitSymbolicLink(this)
    activate SizeCalculator
    SizeCalculator->>SizeCalculator: totalSize += link.size
    Note right of SizeCalculator: ãƒªãƒ³ã‚¯ã‚µã‚¤ã‚ºã‚’åˆè¨ˆã«åŠ ç®—
    SizeCalculator-->>SymbolicLink: å‡¦ç†å®Œäº†
    deactivate SizeCalculator
    SymbolicLink-->>Directory: å‡¦ç†å®Œäº†
    deactivate SymbolicLink
    
    Note over Directory,File: å†å¸°çš„è¨ˆç®—
    Directory->>Directory: å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
    Directory->>Directory: accept(calculator) [å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¯¾ã—ã¦]
    Note right of Directory: å†å¸°çš„ã«å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µã‚¤ã‚ºã‚’è¨ˆç®—
    
    Directory-->>Client: è¨ˆç®—å®Œäº†
    deactivate Directory
    
    Note over Client,SymbolicLink: çµæœå–å¾—ãƒ•ã‚§ãƒ¼ã‚º
    Client->>SizeCalculator: getResult()
    activate SizeCalculator
    SizeCalculator-->>Client: åˆè¨ˆã‚µã‚¤ã‚º
    deactivate SizeCalculator
```

#### 4.3 æ§‹é€ è¦–è¦šåŒ–ãƒ—ãƒ­ã‚»ã‚¹
```mermaid
sequenceDiagram
    participant Client
    participant FileVisualizer
    participant Directory
    participant File
    participant SymbolicLink
    
    Note over Client,SymbolicLink: åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º
    Client->>FileVisualizer: new FileStructureVisualizer()
    Client->>FileVisualizer: setIndentSize(2)
    
    Note over Client,SymbolicLink: è¦–è¦šåŒ–ãƒ•ã‚§ãƒ¼ã‚º
    Client->>Directory: accept(visualizer)
    activate Directory
    Directory->>FileVisualizer: visitDirectory(this)
    activate FileVisualizer
    FileVisualizer->>FileVisualizer: result += "ğŸ“ " + directory.getName()
    Note right of FileVisualizer: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæƒ…å ±ã®è¿½åŠ 
    FileVisualizer-->>Directory: å­è¦ç´ ã®å‡¦ç†ã‚’è¦æ±‚
    deactivate FileVisualizer
    
    Note over Directory,SymbolicLink: å­è¦ç´ ã®è¦–è¦šåŒ–
    FileVisualizer->>FileVisualizer: indentLevel++
    Directory->>File: accept(visualizer)
    activate File
    File->>FileVisualizer: visitFile(this)
    activate FileVisualizer
    FileVisualizer->>FileVisualizer: result += indent + "ğŸ“„ " + file.getName()
    Note right of FileVisualizer: ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆä»˜ãã§ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚’è¿½åŠ 
    FileVisualizer-->>File: å‡¦ç†å®Œäº†
    deactivate FileVisualizer
    File-->>Directory: å‡¦ç†å®Œäº†
    deactivate File
    
    Directory->>SymbolicLink: accept(visualizer)
    activate SymbolicLink
    SymbolicLink->>FileVisualizer: visitSymbolicLink(this)
    activate FileVisualizer
    FileVisualizer->>FileVisualizer: result += indent + "ğŸ”— " + link.getName()
    Note right of FileVisualizer: ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆä»˜ãã§ãƒªãƒ³ã‚¯æƒ…å ±ã‚’è¿½åŠ 
    FileVisualizer-->>SymbolicLink: å‡¦ç†å®Œäº†
    deactivate FileVisualizer
    SymbolicLink-->>Directory: å‡¦ç†å®Œäº†
    deactivate SymbolicLink
    
    Note over Directory,File: å†å¸°çš„è¦–è¦šåŒ–
    Directory->>Directory: å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
    Directory->>Directory: accept(visualizer) [å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¯¾ã—ã¦]
    Note right of Directory: å†å¸°çš„ã«å­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¦–è¦šåŒ–
    FileVisualizer->>FileVisualizer: indentLevel--
    
    Directory-->>Client: è¦–è¦šåŒ–å®Œäº†
    deactivate Directory
    
    Note over Client,SymbolicLink: çµæœå–å¾—ãƒ•ã‚§ãƒ¼ã‚º
    Client->>FileVisualizer: getResult()
    activate FileVisualizer
    FileVisualizer-->>Client: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿éšå±¤ãƒ†ã‚­ã‚¹ãƒˆ
    deactivate FileVisualizer
```

## å®Ÿè£…

### 1. åŸºæœ¬ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 * 
 * ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ãªã©ã®å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚
 * åŸºæœ¬çš„ãªå±æ€§ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚
 */
export interface FileSystemElement {
    /**
     * è¦ç´ ã®åå‰ã‚’å–å¾—ã—ã¾ã™
     * @returns è¦ç´ ã®åå‰
     */
    getName(): string;
    
    /**
     * è¦ç´ ã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’å–å¾—ã—ã¾ã™
     * @returns è¦ç´ ã®çµ¶å¯¾ãƒ‘ã‚¹
     */
    getPath(): string;
    
    /**
     * è¦ç´ ã®ã‚µã‚¤ã‚ºã‚’å–å¾—ã—ã¾ã™ï¼ˆãƒã‚¤ãƒˆå˜ä½ï¼‰
     * @returns ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰
     */
    getSize(): number;
    
    /**
     * è¦ç´ ã®ä½œæˆæ—¥æ™‚ã‚’å–å¾—ã—ã¾ã™
     * @returns ä½œæˆæ—¥æ™‚
     */
    getCreatedAt(): Date;
    
    /**
     * è¦ç´ ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’å–å¾—ã—ã¾ã™
     * @returns æœ€çµ‚æ›´æ–°æ—¥æ™‚
     */
    getModifiedAt(): Date;
}

/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ Visitorã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 * 
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã‚’è¨ªå•ã—ã€ãã‚Œãã‚Œã®è¦ç´ ã«å¯¾ã—ã¦ç‰¹å®šã®æ“ä½œã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
 * æ–°ã—ã„æ“ä½œã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã™ã‚‹æ–°ã—ã„Visitorã‚’ä½œæˆã—ã¾ã™ã€‚
 */
export interface FileSystemVisitor {
    /**
     * ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨ªå•ã—ã¾ã™
     * @param file è¨ªå•ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
     */
    visitFile(file: File): void;

    /**
     * ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨ªå•ã—ã¾ã™
     * @param directory è¨ªå•ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    visitDirectory(directory: Directory): void;

    /**
     * ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’è¨ªå•ã—ã¾ã™
     * @param symlink è¨ªå•ã™ã‚‹ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯
     */
    visitSymbolicLink(symlink: SymbolicLink): void;

    /**
     * è¨ªå•çµæœã‚’å–å¾—ã—ã¾ã™
     * @returns è¨ªå•çµæœ
     */
    getResult(): any;
}

/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 * 
 * Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã¨é€£æºã™ã‚‹ãŸã‚ã®æ‹¡å¼µã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚
 * FileSystemElementã‚’ç¶™æ‰¿ã—ã€visitorã‚’å—ã‘å…¥ã‚Œã‚‹acceptãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚
 */
export interface FileSystemComponent extends FileSystemElement {
    /**
     * Visitorã‚’å—ã‘å…¥ã‚Œã¾ã™
     * @param visitor è¨ªå•è€…
     */
    accept(visitor: FileSystemVisitor): void;
}
```

### 2. ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ã®å®Ÿè£…
```typescript
/**
 * æ¤œç´¢æ¡ä»¶ã‚’å®šç¾©ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 */
export interface SearchCriteria {
    name?: RegExp;           // ãƒ•ã‚¡ã‚¤ãƒ«åã®ãƒ‘ã‚¿ãƒ¼ãƒ³
    minSize?: number;        // æœ€å°ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰
    maxSize?: number;        // æœ€å¤§ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰
    createdAfter?: Date;     // ã“ã®æ—¥æ™‚ä»¥é™ã«ä½œæˆ
    createdBefore?: Date;    // ã“ã®æ—¥æ™‚ä»¥å‰ã«ä½œæˆ
    modifiedAfter?: Date;    // ã“ã®æ—¥æ™‚ä»¥é™ã«æ›´æ–°
    modifiedBefore?: Date;   // ã“ã®æ—¥æ™‚ä»¥å‰ã«æ›´æ–°
}

/**
 * ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ã‚’å®Ÿè¡Œã™ã‚‹Visitorã‚¯ãƒ©ã‚¹
 */
export class FileSearcher implements FileSystemVisitor {
    private results: FileSystemElement[] = [];
    private criteria: SearchCriteria;

    constructor(criteria: SearchCriteria) {
        this.criteria = criteria;
        this.reset();
    }

    visitFile(file: File): void {
        if (this.matchesCriteria(file)) {
            this.results.push(file);
        }
    }

    visitDirectory(directory: Directory): void {
        if (this.matchesCriteria(directory)) {
            this.results.push(directory);
        }
        for (const child of directory.getChildren()) {
            child.accept(this);
        }
    }

    visitSymbolicLink(symlink: SymbolicLink): void {
        if (this.matchesCriteria(symlink)) {
            this.results.push(symlink);
        }
        const target = symlink.getTarget();
        if (target) {
            target.accept(this);
        }
    }

    getResult(): FileSystemElement[] {
        return [...this.results];
    }

    private matchesCriteria(element: FileSystemElement): boolean {
        const { name, minSize, maxSize, createdAfter, createdBefore, 
                modifiedAfter, modifiedBefore } = this.criteria;

        if (name && !name.test(element.getName())) return false;
        
        const size = element.getSize();
        if (minSize !== undefined && size < minSize) return false;
        if (maxSize !== undefined && size > maxSize) return false;

        const createdAt = element.getCreatedAt();
        if (createdAfter && createdAt < createdAfter) return false;
        if (createdBefore && createdAt > createdBefore) return false;

        const modifiedAt = element.getModifiedAt();
        if (modifiedAfter && modifiedAt < modifiedAfter) return false;
        if (modifiedBefore && modifiedAt > modifiedBefore) return false;

        return true;
    }

    reset(): void {
        this.results = [];
    }
}
```

### 3. ã‚µã‚¤ã‚ºè¨ˆç®—ã®å®Ÿè£…
```typescript
/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã®ã‚µã‚¤ã‚ºã‚’è¨ˆç®—ã™ã‚‹Visitorã‚¯ãƒ©ã‚¹
 */
export class SizeCalculator implements FileSystemVisitor {
    private totalSize: number = 0;
    private details: Map<string, number> = new Map();

    visitFile(file: File): void {
        const size = file.getSize();
        this.totalSize += size;
        this.details.set(file.getPath(), size);
    }

    visitDirectory(directory: Directory): void {
        let dirSize = 0;
        for (const child of directory.getChildren()) {
            const prevSize = this.totalSize;
            child.accept(this);
            dirSize += this.totalSize - prevSize;
        }
        this.details.set(directory.getPath(), dirSize);
    }

    visitSymbolicLink(symlink: SymbolicLink): void {
        const size = symlink.getSize();
        this.totalSize += size;
        this.details.set(symlink.getPath(), size);
    }

    getResult(): number {
        return this.totalSize;
    }

    reset(): void {
        this.totalSize = 0;
        this.details.clear();
    }

    static formatSize(bytes: number): string {
        const units = ['B', 'KB', 'MB', 'GB', 'TB'];
        let size = bytes;
        let unitIndex = 0;

        while (size >= 1024 && unitIndex < units.length - 1) {
            size /= 1024;
            unitIndex++;
        }

        return `${size.toFixed(1)} ${units[unitIndex]}`;
    }
}
```

### 4. æ§‹é€ è¦–è¦šåŒ–ã®å®Ÿè£…
```typescript
/**
 * ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®éšå±¤æ§‹é€ ã‚’è¦–è¦šåŒ–ã™ã‚‹Visitorã‚¯ãƒ©ã‚¹
 */
export class FileStructureVisualizer implements FileSystemVisitor {
    private result: string = '';
    private currentIndent: number = 0;
    private indentSize: number = 2;

    setIndentSize(size: number): void {
        if (size < 1) {
            throw new Error('ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºã¯1ä»¥ä¸Šã®æ•´æ•°ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');
        }
        this.indentSize = size;
    }

    visitFile(file: File): void {
        this.result += this.getIndentation();
        this.result += `ğŸ“„ ${file.getName()} (${this.formatSize(file.getSize())})`;
        this.result += '\n';
    }

    visitDirectory(directory: Directory): void {
        this.result += this.getIndentation();
        this.result += `ğŸ“ ${directory.getName()} (${this.formatSize(directory.getSize())})`;
        this.result += '\n';

        if (directory.isEmpty()) {
            this.currentIndent++;
            this.result += this.getIndentation();
            this.result += '(ç©ºã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)';
            this.result += '\n';
            this.currentIndent--;
            return;
        }

        this.currentIndent++;
        for (const child of directory.getChildren()) {
            child.accept(this);
        }
        this.currentIndent--;
    }

    visitSymbolicLink(symlink: SymbolicLink): void {
        this.result += this.getIndentation();
        this.result += `ğŸ”— ${symlink.getName()} -> ${symlink.getTargetPath()} `;
        this.result += `(${this.formatSize(symlink.getSize())})`;
        this.result += '\n';
    }

    getResult(): string {
        return this.result.trim();
    }

    private getIndentation(): string {
        return ' '.repeat(this.currentIndent * this.indentSize);
    }

    private formatSize(bytes: number): string {
        const units = ['B', 'KB', 'MB', 'GB', 'TB'];
        let size = bytes;
        let unitIndex = 0;

        while (size >= 1024 && unitIndex < units.length - 1) {
            size /= 1024;
            unitIndex++;
        }

        return `${size.toFixed(1)} ${units[unitIndex]}`;
    }

    reset(): void {
        this.result = '';
        this.currentIndent = 0;
    }
}
```

### 5. ä½¿ç”¨ä¾‹

```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã®æ§‹ç¯‰
const root = new Directory("root", "/");

// ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
const home = new Directory("home", "/home");
const user = new Directory("user", "/home/user");
const documents = new Directory("documents", "/home/user/documents");
const pictures = new Directory("pictures", "/home/user/pictures");

// ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
const resume = new File("resume.pdf", 1024 * 1024, "/home/user/documents/resume.pdf");
const report = new File("report.docx", 2.5 * 1024 * 1024, "/home/user/documents/report.docx");
const photo1 = new File("vacation.jpg", 5 * 1024 * 1024, "/home/user/pictures/vacation.jpg");
const photo2 = new File("family.jpg", 3.2 * 1024 * 1024, "/home/user/pictures/family.jpg");
const config = new File(".config", 2048, "/home/user/.config");

// ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã®ä½œæˆ
const resumeLink = new SymbolicLink("resume-link", resume, "/home/user/resume-link");

// ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®æ§‹ç¯‰
root.add(home);
home.add(user);
user.add(documents);
user.add(pictures);
user.add(config);
documents.add(resume);
documents.add(report);
pictures.add(photo1);
pictures.add(photo2);
user.add(resumeLink);

// ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ã®ä½¿ç”¨ä¾‹
const criteria: SearchCriteria = {
  name: /\.jpg$/,
  minSize: 1024 * 1024,
  maxSize: 10 * 1024 * 1024
};
const fileSearcher = new FileSearcher(criteria);

// ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰æ¤œç´¢ã‚’é–‹å§‹
root.accept(fileSearcher);

// æ¤œç´¢çµæœã®å–å¾—ã¨è¡¨ç¤º
const foundFiles = fileSearcher.getResult();
console.log("JPGç”»åƒãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢çµæœ:");
foundFiles.forEach(file => {
  console.log(`- ${file.getName()}: ${file.getSize()} bytes (${file.getPath()})`);
});

// ã‚µã‚¤ã‚ºè¨ˆç®—ã®ä½¿ç”¨ä¾‹
const sizeCalculator = new SizeCalculator();

// picturesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µã‚¤ã‚ºã‚’è¨ˆç®—
pictures.accept(sizeCalculator);
console.log(`å†™çœŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µã‚¤ã‚º: ${SizeCalculator.formatSize(sizeCalculator.getResult())}`);

// rootãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µã‚¤ã‚ºã‚’è¨ˆç®—
sizeCalculator.reset();
root.accept(sizeCalculator);
console.log(`ç·åˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µã‚¤ã‚º: ${SizeCalculator.formatSize(sizeCalculator.getResult())}`);

// ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®è¦–è¦šåŒ–ã®ä½¿ç”¨ä¾‹
const visualizer = new FileStructureVisualizer();
visualizer.setIndentSize(2); // ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºã®è¨­å®š

// ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ§‹é€ ã‚’è¦–è¦šåŒ–
root.accept(visualizer);
console.log("ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ :");
console.log(visualizer.getResult());
```

å‡ºåŠ›ä¾‹ï¼š
```
JPGç”»åƒãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢çµæœ:
- vacation.jpg: 5242880 bytes (/home/user/pictures/vacation.jpg)
- family.jpg: 3355443 bytes (/home/user/pictures/family.jpg)
å†™çœŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚µã‚¤ã‚º: 8.2 MB
ç·åˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µã‚¤ã‚º: 12.1 MB
ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ :
/
â””â”€ home/
   â””â”€ user/
      â”œâ”€ documents/
      â”‚  â”œâ”€ resume.pdf (1.0 MB)
      â”‚  â””â”€ report.docx (2.5 MB)
      â”œâ”€ pictures/
      â”‚  â”œâ”€ vacation.jpg (5.0 MB)
      â”‚  â””â”€ family.jpg (3.2 MB)
      â”œâ”€ .config (2.0 KB)
      â””â”€ resume-link -> /home/user/documents/resume.pdf (1.0 MB)
```

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### 1. ãƒ†ã‚¹ãƒˆã®ç¨®é¡ã¨ç›®çš„
ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®Visitorãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã¾ã™ï¼š

1. **å˜ä½“ãƒ†ã‚¹ãƒˆ**ï¼š
   - å„Visitorã‚¯ãƒ©ã‚¹ãŒå€‹åˆ¥ã«æ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
   - å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è¦ç´ ã‚¯ãƒ©ã‚¹ãŒæ­£ã—ãçŠ¶æ…‹ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
   - ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚„å¢ƒç•Œæ¡ä»¶ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ¤œè¨¼

2. **çµ±åˆãƒ†ã‚¹ãƒˆ**ï¼š
   - è¤‡æ•°ã®VisitorãŒåŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã«å¯¾ã—ã¦é€£ç¶šã—ã¦å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
   - å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’æ¨¡æ“¬ã—ãŸã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**ï¼š
   - å¤§è¦æ¨¡ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã«å¯¾ã™ã‚‹åŠ¹ç‡æ€§ã®æ¤œè¨¼
   - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç›£è¦–

### 2. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹

#### FileSearcherã®ãƒ†ã‚¹ãƒˆ

```typescript
describe('FileSearcher', () => {
  let root: Directory;
  let documents: Directory;
  let pictures: Directory;
  let textFile1: File;
  let textFile2: File;
  let imageFile1: File;
  let imageFile2: File;
    let searcher: FileSearcher;

    beforeEach(() => {
    // ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’æ§‹ç¯‰
    root = new Directory('root');
    documents = new Directory('documents', '/documents');
    pictures = new Directory('pictures', '/pictures');
    
    textFile1 = new File('report.txt', 1024, '/documents/report.txt');
    textFile2 = new File('notes.txt', 512, '/documents/notes.txt');
    imageFile1 = new File('photo.jpg', 2048, '/pictures/photo.jpg');
    imageFile2 = new File('screenshot.png', 4096, '/pictures/screenshot.png');
    
    root.add(documents);
    root.add(pictures);
    documents.add(textFile1);
    documents.add(textFile2);
    pictures.add(imageFile1);
    pictures.add(imageFile2);
    
    searcher = new FileSearcher();
  });
  
  test('åå‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢', () => {
    searcher.setSearchCriteria({ namePattern: /\.txt$/ });
    root.accept(searcher);
    const result = searcher.getResult();
    
    expect(result.length).toBe(2);
    expect(result).toContain(textFile1);
    expect(result).toContain(textFile2);
    expect(result).not.toContain(imageFile1);
    expect(result).not.toContain(imageFile2);
  });
  
  test('ã‚µã‚¤ã‚ºç¯„å›²ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢', () => {
    searcher.setSearchCriteria({ minSize: 1000, maxSize: 3000 });
    root.accept(searcher);
    const result = searcher.getResult();
    
    expect(result.length).toBe(2);
    expect(result).toContain(textFile1);
    expect(result).toContain(imageFile1);
    expect(result).not.toContain(textFile2); // 512ãƒã‚¤ãƒˆã¯ç¯„å›²å¤–
    expect(result).not.toContain(imageFile2); // 4096ãƒã‚¤ãƒˆã¯ç¯„å›²å¤–
  });
  
  test('è¤‡åˆæ¡ä»¶ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢', () => {
    searcher.setSearchCriteria({
      namePattern: /\.(jpg|png)$/,
      minSize: 3000
    });
    root.accept(searcher);
    const result = searcher.getResult();
    
    expect(result.length).toBe(1);
    expect(result).toContain(imageFile2);
  });
  
  test('ä¸æ­£ãªæ¤œç´¢æ¡ä»¶ã®å‡¦ç†', () => {
    // ä¸æ­£ãªæ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³
    expect(() => {
      searcher.setSearchCriteria({ namePattern: /[/ });
    }).toThrow();
    
    // è² ã®ã‚µã‚¤ã‚ºå€¤
    expect(() => {
      searcher.setSearchCriteria({ minSize: -100 });
    }).toThrow();
  });
});
```

#### SizeCalculatorã®ãƒ†ã‚¹ãƒˆ

```typescript
describe('SizeCalculator', () => {
  let root: Directory;
  let file1: File;
  let file2: File;
  let emptyDir: Directory;
  let calculator: SizeCalculator;
  
  beforeEach(() => {
    root = new Directory('root', '/');
    file1 = new File('file1.txt', 1024, '/file1.txt');
    file2 = new File('file2.txt', 2048, '/file2.txt');
    emptyDir = new Directory('empty', '/empty');
    
    root.add(file1);
    root.add(file2);
    root.add(emptyDir);
    
    calculator = new SizeCalculator();
  });
  
  test('ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ã‚µã‚¤ã‚ºè¨ˆç®—', () => {
    root.accept(calculator);
    
    // ãƒ•ã‚¡ã‚¤ãƒ«åˆè¨ˆ: 1024 + 2048 = 3072
    // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: root: 4096, empty: 4096 = 8192
    // åˆè¨ˆ: 11264ãƒã‚¤ãƒˆ
    
    calculator.setSizeFormat('bytes');
    expect(calculator.getResult()).toBe('11264 bytes');
    
    calculator.setSizeFormat('human');
    expect(calculator.getResult()).toBe('11.0 KB');
  });
  
  test('ç©ºã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µã‚¤ã‚ºè¨ˆç®—', () => {
    emptyDir.accept(calculator);
    
    calculator.setSizeFormat('bytes');
    expect(calculator.getResult()).toBe('4096 bytes'); // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ã¿
  });
  
  test('è¨ˆç®—ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½', () => {
    root.accept(calculator);
    expect(parseInt(calculator.getResult())).toBeGreaterThan(0);
    
    calculator.resetTotalSize();
    calculator.setSizeFormat('bytes');
    expect(calculator.getResult()).toBe('0 bytes');
  });
});
```

#### FileStructureVisualizerã®ãƒ†ã‚¹ãƒˆ

```typescript
describe('FileStructureVisualizer', () => {
  let root: Directory;
  let documents: Directory;
  let imageFile: File;
  let visualizer: FileStructureVisualizer;
  
  beforeEach(() => {
    root = new Directory('root', '/');
    documents = new Directory('documents', '/documents');
    imageFile = new File('photo.jpg', 1024 * 1024, '/documents/photo.jpg');
    
    root.add(documents);
    documents.add(imageFile);
    
    visualizer = new FileStructureVisualizer();
  });
  
  test('ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®è¦–è¦šåŒ–', () => {
    root.accept(visualizer);
    const result = visualizer.getResult();
    
    // çµæœã«ç‰¹å®šã®æ§‹é€ ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(result).toContain('/');
    expect(result).toContain('documents/');
    expect(result).toContain('photo.jpg');
    expect(result).toContain('1.0 MB'); // ã‚µã‚¤ã‚ºè¡¨ç¤º
  });
  
  test('ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºã®è¨­å®š', () => {
    visualizer.setIndentSize(4);
    root.accept(visualizer);
    const result = visualizer.getResult();
    
    // 4ã‚¹ãƒšãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(result).toContain('\n    ');
  });
  
  test('ä¸æ­£ãªã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚µã‚¤ã‚ºã®å‡¦ç†', () => {
    expect(() => {
      visualizer.setIndentSize(-1);
    }).toThrow();
    
    expect(() => {
      visualizer.setIndentSize(0);
    }).toThrow();
  });
});
```

#### çµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
describe('Visitorçµ±åˆãƒ†ã‚¹ãƒˆ', () => {
  let fileSystem: Directory;
  
  beforeEach(() => {
    // è¤‡é›‘ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’æ§‹ç¯‰
    fileSystem = createTestFileSystem();
  });
  
  test('è¤‡æ•°ã®Visitorã®é€£ç¶šé©ç”¨', () => {
    // ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
    const searcher = new FileSearcher();
    searcher.setSearchCriteria({ namePattern: /\.txt$/ });
    fileSystem.accept(searcher);
    const searchResults = searcher.getResult();
    
    // ã‚µã‚¤ã‚ºè¨ˆç®—
    const calculator = new SizeCalculator();
    fileSystem.accept(calculator);
    const totalSize = calculator.getResult();
    
    // æ§‹é€ è¦–è¦šåŒ–
    const visualizer = new FileStructureVisualizer();
    fileSystem.accept(visualizer);
    const structure = visualizer.getResult();
    
    // æ¤œè¨¼
    expect(searchResults.length).toBe(3); // .tsãƒ•ã‚¡ã‚¤ãƒ«ã¯3ã¤
    expect(totalSize).toBeGreaterThan(15000); // åˆè¨ˆã‚µã‚¤ã‚ºã¯15KBä»¥ä¸Š
    expect(structure).toContain('project');
    expect(structure).toContain('src');
    expect(structure).toContain('tests');
    expect(structure).toContain('docs');
  });
});
```

### 3. ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

ä»¥ä¸‹ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã‚’è¨­å®šã—ã¾ã™ï¼š

- **ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 90%ä»¥ä¸Š
- **åˆ†å²ã‚«ãƒãƒ¬ãƒƒã‚¸**: 85%ä»¥ä¸Š
- **é–¢æ•°ã‚«ãƒãƒ¬ãƒƒã‚¸**: 95%ä»¥ä¸Š
- **è¡Œã‚«ãƒãƒ¬ãƒƒã‚¸**: 90%ä»¥ä¸Š

### 4. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ–¹æ³•

ãƒ†ã‚¹ãƒˆã¯Jestãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã—ã¾ã™ï¼š

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm test

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å®Ÿè¡Œ
npm test -- FileSearcher.test.ts

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ
npm test -- --coverage
```

### 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã«é–¢é€£ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …ã¨ã—ã¦ã€ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¾ã™ï¼š

1. **ç„¡é™å†å¸°ã®é˜²æ­¢**:
   - ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ãŒå¾ªç’°å‚ç…§ã‚’ä½œæˆã—ã¦ã„ã‚‹å ´åˆã®ç„¡é™å†å¸°ã‚’é˜²æ­¢ã™ã‚‹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
   - è¨ªå•ã—ãŸè¦ç´ ã‚’è¿½è·¡ã™ã‚‹è¨ªå•å±¥æ­´ã®ç®¡ç†

   ```typescript
   class SafeFileSystemVisitor implements FileSystemVisitor {
     private visitedPaths = new Set<string>();
     
     visitDirectory(directory: Directory): void {
       const path = directory.getPath();
       if (this.visitedPaths.has(path)) {
         // å¾ªç’°æ¤œå‡ºã€å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
         return;
       }
       
       this.visitedPaths.add(path);
       // é€šå¸¸ã®å‡¦ç†...
     }
   }
   ```

2. **ãƒªã‚½ãƒ¼ã‚¹æ¶ˆè²»ã®åˆ¶é™**:
   - å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’å‡¦ç†ã™ã‚‹éš›ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®åˆ¶é™
   - å‡¦ç†æ™‚é–“ã®åˆ¶é™ã¨å®šæœŸçš„ãªé€²æ—å ±å‘Š

```typescript
   class ResourceAwareVisitor implements FileSystemVisitor {
     private processedCount = 0;
     private readonly maxItems = 10000;
     
     visitFile(file: File): void {
       if (this.processedCount >= this.maxItems) {
         throw new Error("å‡¦ç†é …ç›®æ•°ã®ä¸Šé™ã«é”ã—ã¾ã—ãŸ");
       }
       
       this.processedCount++;
       // é€šå¸¸ã®å‡¦ç†...
     }
   }
   ```

3. **å…¥åŠ›æ¤œè¨¼**:
   - ãƒ•ã‚¡ã‚¤ãƒ«åã‚„ãƒ‘ã‚¹ã«å«ã¾ã‚Œã‚‹ç‰¹æ®Šæ–‡å­—ã®é©åˆ‡ãªå‡¦ç†
   - æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ãªã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®æ¤œè¨¼

   ```typescript
   class ValidatingFileSearcher extends FileSearcher {
     setSearchCriteria(criteria: SearchCriteria): void {
       // namePatternã®æ¤œè¨¼
       if (criteria.namePattern && !(criteria.namePattern instanceof RegExp)) {
         throw new Error("namePatternã¯æœ‰åŠ¹ãªæ­£è¦è¡¨ç¾ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
       }
       
       // ã‚µã‚¤ã‚ºç¯„å›²ã®æ¤œè¨¼
        if (criteria.minSize !== undefined && criteria.minSize < 0) {
         throw new Error("minSizeã¯0ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
       }
       
       if (criteria.maxSize !== undefined && criteria.maxSize < 0) {
         throw new Error("maxSizeã¯0ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
       }
       
       if (criteria.minSize !== undefined && 
           criteria.maxSize !== undefined && 
           criteria.minSize > criteria.maxSize) {
         throw new Error("minSizeã¯maxSizeä»¥ä¸‹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
       }
       
       super.setSearchCriteria(criteria);
    }
}
```

## å®Ÿè£…ã®è©•ä¾¡

Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨æ“ä½œã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§ã€æ–°ã—ã„æ©Ÿèƒ½ã‚’å®¹æ˜“ã«è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã®æ–‡è„ˆã§Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…ä¾‹ã‚’ç¤ºã—ã¾ã—ãŸã€‚

### ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **åˆ†é›¢ã®åŸå‰‡**
   - ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã¨æ“ä½œï¼ˆæ¤œç´¢ã€è¨ˆç®—ã€è¦–è¦šåŒ–ï¼‰ã‚’æ˜ç¢ºã«åˆ†é›¢
   - æ–°ã—ã„æ“ä½œã‚’è¿½åŠ ã™ã‚‹éš›ã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒãªã„

2. **æ‹¡å¼µæ€§**
   - æ–°ã—ã„ãƒ“ã‚¸ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã€æ–°æ©Ÿèƒ½ã‚’å®Ÿè£…å¯èƒ½
   - ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å¤‰æ›´ã«å¼·ã„è¨­è¨ˆ

3. **ã‚¯ãƒªãƒ¼ãƒ³ãªå®Ÿè£…**
   - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é€šã˜ãŸæ˜ç¢ºãªè²¬ä»»åˆ†æ‹…
   - å‹å®‰å…¨ãªãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ãƒƒã‚¯ãªæ“ä½œ

4. **å®Ÿè·µçš„ãªå¿œç”¨**
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ 
   - æŠ½è±¡æ§‹æ–‡æœ¨
   - UIè¦ç´ 
   - ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### æ³¨æ„ç‚¹

1. **è¤‡é›‘æ€§**
   - ã‚¯ãƒ©ã‚¹æ•°ãŒå¢—åŠ ã™ã‚‹å¯èƒ½æ€§
   - é–¢é€£ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å®Ÿè£…ã®ç†è§£ãŒå¿…è¦

2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®**
   - å†å¸°å‡¦ç†ã®æœ€é©åŒ–
   - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç®¡ç†

3. **é©ç”¨ç¯„å›²**
   - å®‰å®šã—ãŸãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¯¾ã—ã¦æœ€ã‚‚åŠ¹æœçš„
   - é »ç¹ã«å¤‰æ›´ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«ã¯ä¸å‘ã

Visitorãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€ã€Œæ“ä½œã€ã¨ã€Œãƒ‡ãƒ¼ã‚¿ã€ã®åˆ†é›¢ã‚’é‡è¦–ã™ã‚‹çŠ¶æ³ã§ç‰¹ã«ä¾¡å€¤ã‚’ç™ºæ®ã—ã¾ã™ã€‚ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©åˆ‡ã«æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ä¿å®ˆæ€§ã€æ‹¡å¼µæ€§ã€ãã—ã¦å†åˆ©ç”¨æ€§ã®é«˜ã„ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## å‚è€ƒè³‡æ–™

1. Gamma, E., Helm, R., Johnson, R., & Vlissides, J. (1994). Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley.
2. Martin, R. C. (2017). Clean Architecture: A Craftsman's Guide to Software Structure and Design. Prentice Hall.
3. Fowler, M. (2002). Patterns of Enterprise Application Architecture. Addison-Wesley.
4. [TypeScript Documentation](https://www.typescriptlang.org/docs/)
5. [ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚°ãƒ« - Visitorãƒ‘ã‚¿ãƒ¼ãƒ³](https://refactoring.guru/ja/design-patterns/visitor) 