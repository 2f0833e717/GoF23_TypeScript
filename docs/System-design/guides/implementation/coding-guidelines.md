# コーディング規約

このドキュメントでは、GoF23デザインパターンTypeScript実装プロジェクトのコーディング規約とベストプラクティスについて説明します。

## 1. ファイル構成
- 1ファイルにつき1つの主要なクラス/インターフェース
- ファイル名はクラス名と一致させる
- ディレクトリ構造はパターンカテゴリに従う
- ファイル構成例:
  ```
  src/
  ├── behavioral/
  │   └── observer/
  │       ├── index.ts         # 公開APIのエントリーポイント
  │       ├── Subject.ts       # インターフェース定義
  │       ├── Observer.ts      # インターフェース定義
  │       ├── ConcreteSubject.ts # 具象クラス
  │       └── ConcreteObserver.ts # 具象クラス
  ```

## 2. 命名規則
- **クラス/インターフェース**: PascalCase（例: `Observer`, `ConcreteSubject`）
- **変数/メソッド/プロパティ**: camelCase（例: `attach`, `notifyObservers`）
- **定数**: UPPER_SNAKE_CASE（例: `MAX_OBSERVERS`）
- **ファイル名**: インターフェースや抽象クラスにはPascalCase、実装にはパターン名を含める
- **命名の一般原則**:
  - 明確で説明的な名前を使用する
  - 略語は一般的なもののみ使用する
  - ハンガリアン記法を避ける
  - boolean変数/メソッドには`is`, `has`, `can`などの接頭辞を使用する
  - 複数形は配列やコレクションに使用する（例: `users`, `products`）

## 3. コードフォーマット
- TypeScriptの標準スタイルに従う
- インデントは2スペース
- 最大行長は100文字
- セミコロンは必須
- 波括弧は同じ行に開き、新しい行で閉じる
- 単一行のブロックでも波括弧を使用する
- 空白行でロジカルなブロックを分ける
- コードフォーマッタ（Prettier）を使用して一貫性を維持する

## 4. 型定義
- `any`型の使用を最小限に抑える
- 適切な場所でジェネリック型を活用する
- インターフェースを優先し、必要な場合のみ型エイリアスを使用する
- 共通の型定義は集中管理する
- リテラル型やユニオン型を活用して型安全性を高める
- 明示的な戻り値型の宣言を推奨
- 型ガード関数を活用して型の絞り込みを行う

## 5. TypeScript固有の機能活用
- **Readonly修飾子**: イミュータブルデータを表現するために使用
- **Partial/Required/Pick/Omit**: 型の変換に活用
- **ユーティリティ型**: ReturnType, Parameters などを使用して型の再利用性を高める
- **Conditional Types**: 条件に基づいた型の選択
- **Mapped Types**: オブジェクト型のプロパティを変換
- **Nullish Coalescing**: `??` 演算子を使用してnull/undefinedのみに対応
- **Optional Chaining**: `?.` を使用して安全にプロパティにアクセス

## 6. エラーハンドリング
- 具体的なエラークラスを定義し、エラーの種類を明確にする
- エラーメッセージは具体的で解決方法のヒントを含める
- 例外はキャッチして適切に処理する
- 非同期エラーは適切にハンドリングする
- `try-catch`ブロックのスコープを最小限に保つ
- エラーログを適切なレベル（debug/info/warn/error）で出力する
- Result型パターンを使用して例外に頼らないエラーハンドリングを検討する

## 7. 非同期処理
- Promise APIよりasync/awaitを優先する
- 適切なエラーハンドリングを行う（try-catch）
- Promise.allを活用して並列処理を行う
- 長時間実行される処理にはタイムアウト機構を組み込む
- 非同期処理のキャンセル機構を考慮する
- ステータス管理とユーザーへのフィードバックを提供する

## 8. コメント
- JSDocスタイルのコメントを使用する
- すべての公開API、クラス、インターフェースにドキュメントコメントを付ける
- パラメータ、戻り値、例外に関する情報を含める
- 実装の「なぜ」に焦点を当て、「何を」や「どのように」は自明なコードで表現する
- サンプルコードや使用例を含める
- コメント例:
  ```typescript
  /**
   * オブザーバーに通知する責務を持つインターフェース
   * @template T 通知するデータの型
   */
  interface Subject<T> {
    /**
     * オブザーバーを登録する
     * @param observer 登録するオブザーバー
     * @throws {Error} 登録上限に達している場合
     */
    attach(observer: Observer<T>): void;
    
    // その他のメソッド...
  }
  ``` 